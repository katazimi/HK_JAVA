<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script type="text/javascript">
	function ajaxGet(){
		const xhr=new XMLHttpRequest();
		
		let params="num=1&id=hk";
		
		//		(요청방식, 요청주소, 비동기여부)
		xhr.open("GET","data.json?"+params,true);
		
		xhr.onreadystatechange=function(){
			if(xhr.readyState===4 && xhr.status === 200){
				let data = JSON.parse(xhr.responseText);
				console.log(data.id, data.name);
				
				document.querySelector("#result").innerHTML=`<p>${data.id}</p><p>${data.name}</p><p>${data.addr}</p>`
			}
		}
		
		//요청을 서버로 전송
		xhr.send();
	}
	
	/* getUser(id){
		const userinfo=data;
		setBoard(userinfo.id); //사용자의 게시글 가져오기
		getTest(board.id); //특정글 가져오기
	}*/
	
	// promise 객체
	// 여러 ajax처리 작업을 연결한다면 콜백함수를 많이 써야되는 경우가 생김
	// -> 콜백함수를 해결하고 비동기 작업에 성공/실패를 깔끔하게 처리하는 객체
	
	function promiseTest(method,url,data=null) {
		return new promise((resolve,reject)=>{
			const xhr=new XMLHttpRequest();
			const params="num=1&id=hk";
			xhr.open(method,url,true);
			xhr.onreadystatechange=()=>{
				if(xhr.readyState===4){
					if(xhr.status>=200 && xhr.status < 300){
						//응답 데이터 처리
						resolve(xhr.responseText);
					}else{
						//요청 실패에 대한 처리
						reject(new Error("요청실패"));
					}
				}
			}
		});
	}
	
	//promise 사용
	function ajaxPromise(){
		promiseTest("GET","data.json").then((response)=>{
											const data=JSON.parse(response);
											console.log(data);
										}).then()
										.catch(error=>{
											console.log("실패:"+error);
										})
	}
	
	//promise 기반 AJAX처리 API - fetch()
	/*fetch('data.json').then(response=>{
		
						}).then(str=>{

						}).catch(error=>{
							console.log("실패: ",error);
						});
	*/
</script>
</head>
<body>
	<button onclick="ajaxGet()">Get방식</button>
	<div id="result"></div>
</body>
</html>